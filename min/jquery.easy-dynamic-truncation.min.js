/* (c) Aaron Gustafson (@AaronGustafson). MIT License. http://github.com/easy-designs/jquery.easy-dynamic-truncation.js */
(function(e,g,m,t){var p=false,c="click",d="truncate",s=d+"-reveal",q=d+"-hide",i=d+"-collapsed",j=d+"-max-items",b="[data-"+j+"]",o=d+"-char-limit",a=d+"-auto-display",k=d+"-exclude",h=e(b),n=e('<div class="more-link"><a class="'+s+'" href="#show-more">More</a></div>'),l='<b class="'+d+'-string">',f="</b>",r=e('<i class="'+d+'-ellipsis">\u2026</i>');if("ontouchstart" in g||"createTouch" in m){c="touchend"}h.each(function(){var D=e(this),G=D.data(j),v=D.data(k),z=D.data(a),J=D.is("[data-"+d+"-collapsible]"),A=p,I=0,u=e([]),C=D.is("[data-"+d+"-embed]"),w=D.siblings(".more-link"),F=(w.length>0),B,E=(v!=t?D.children(":not("+v+")"):D.children()).filter(":not(.more-link)");if(z!=t){z=e(g).width()>=z}if(D.is("[data-"+o+"]")){A=parseInt(D.data(o),10);E.each(function(){var M=e(this),O=M.text(),K=M.html(),N=O.split(" "),L=O.length;M.addClass(k);if((I+L)>A){e.each(N,function(Q,S){var R=S.length+1,P;if(I+R>A){P=N[Q-2]+" "+N[Q-1]+" ";M.html(K.replace(P,P+l)+f);return p}I+=R});return p}I+=L});E=E.filter(":not(."+k+")");u=e("."+d+"-string")}else{if(G!=t){E=E.eq(G-1).nextAll()}}function H(K){var L=K.parent();E.add(u).removeClass(i);K.removeClass(s);if(J){K.text("Less").addClass(q);if(C){E.last().append(w);w.find("."+d+"-ellipsis").remove()}}else{if(!F){if(L.is(".more-link")){L.remove()}else{K.remove()}}else{K.html(K.html().replace("More","All"));w.off(c,"a",x)}}}function y(K){var L=E.eq(0).prev();if(L.length<1){L=u.closest("."+k+")")}if(!z&&E.length){E.add(u).addClass(i);if(K!=t){K.text("More").addClass(s).removeClass(q);if(C){L.append(w.prepend(r.clone()))}}else{if(!F){w=n.clone();if(C){w=w.find("a").wrap('<span class="more-link"/>').parent().prepend(r.clone());L.append(w)}else{D.closest(":not(ol,ul,dl)").append(w)}}else{K=w.find("a").addClass(s);K.html(K.html().replace("All","More"))}}}}function x(L){var K=e(this);if(K.is("."+s)){H(K)}else{y(K)}L.preventDefault()}y();w.on(c,"a",x)})})(jQuery,window,document);